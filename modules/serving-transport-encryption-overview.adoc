// Module included in the following assemblies:
//
// * knative-serving/serving-transport-encryption.adoc
:_mod-docs-content-type: CONCEPT
[id="serving-transport-encryption-overview_{context}"]
= Overview of Serving transport encryption

There are three parts to {ServerlessProductName} Serving transport encryption:

External domain encryption:: Transport encryption on the ingress layer external to the cluster. For example, a cluster-external domain, such as `myapp-<namespace>.example.com`.

Cluster-local encryption:: Transport encryption on the ingress layer internal to the cluster. For example, cluster-local domains, such as `myapp.<namespace>.svc.cluster.local`.

System-internal encryption:: Transport encryption between the `ingress-gateway`, `activator`, and `queue-proxy` Knative internal components.

[IMPORTANT]
====
Control-plane traffic, including Kubernetes PreStopHooks, metadata, and metrics, contains no user data and is not encrypted.
====

The different parts are independent of each other and can be enabled and disabled individually. They can use the same or different Certificate Authorities (CAs) to sign the necessary certificates.

[NOTE]
====
For diagrams illustrating transport encryption, see link:https://openshift-knative.github.io/docs/docs/latest/serverless/serving/serving-transport-encryption.html[{ServerlessProductName} Serving Transport Encryption].
====

[id="serving-transport-encryption-external-domain_{context}"]
== External domain encryption

The transport encryption for external domains is handled by the ingress layer of the cluster, which is either the {ocp-product-title} ingress or {SMProductName}.

[id="serving-transport-encryption-cluster-local-encryption_{context}"]
== Cluster-local encryption

Cluster-local encryption enables transport encryption for cluster-local domains. It has the following properties:

* The Certificate Common Name (CN) or Subject Alternative Name (SAN) contains the cluster-local domains of a Knative Service, for example `myapp.namespace.svc.cluster.local`, `myapp.namespace.svc`, `myapp.namespace`.

* The cluster-local endpoint of the `ingress-controller` component uses SNI to select the certificates.

* To create the certificates, Knative relies on `cert-manager`, which needs to be installed and configured for the feature to work. For more information, see link:https://docs.redhat.com/en/documentation/openshift_container_platform/4.17/html/security_and_compliance/cert-manager-operator-for-red-hat-openshift#cert-manager-operator-release-notes-1-14-0[{cert-manager-operator}].

[IMPORTANT]
====
The caller must trust the CA that signed the cluster-local certificates. This is out of the scope of {ServerlessProductName}.
====

[id="serving-transport-encryption-system-internal-encryption_{context}"]
== System-internal encryption

System-internal encryption enables transport encryption for the `ingress-gateway`, `activator`, and `queue-proxy` Knative internal components. These components host TLS endpoints when this configuration is used.

The following prerequisites must be satisfied to use this feature:

* For {ServerlessProductName} to get the certificates, `cert-manager` must be installed and configured.

* Specific SANs are used to verify each connection. Each component must trust the CA that signed the certificates. To satisfy this requirement, {ServerlessProductName} system components consume and trust a bundle of CAs. The CA bundle must be provided by the cluster administrator.
